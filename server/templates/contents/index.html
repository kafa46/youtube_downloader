<!-- templates/contents/index.html -->

{% extends '/home/base.html' %}

{% block head %}
<script type="module">
  import { initTubeSearch } from "/static/js/tube_search.js?v=1.0.1";
  initTubeSearch();
</script>

<!-- tube_search.jsë¥¼ ëª¨ë“ˆí™” í•˜ì—¬ js/tube/... ìœ¼ë¡œ êµ¬ì„±í–ˆì„ ê²½ìš° ì‚¬ìš©í•˜ëŠ” ë°©ì‹ -->
<!-- ëª¨ë“ˆí™” ì—ëŸ¬ê°€ ìˆì–´ ì•„ì§ì€ ì ìš©í•˜ì§€ ëª»í•¨. -->
<!-- <script type="module">
  import { initTubeSearch } from "/static/js/tube/index.js";
  initTubeSearch();
</script> -->

<!-- Font Awesome CDN ì¶”ê°€ -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css">
{% endblock %}

{% block contents %}
<!-- ìœ íŠœë¸Œ ì¹´ë“œ ë‚´ë¶€ì— ìˆëŠ” ë‹¤ìš´ë¡œë“œ í´ë¦­ ì‹œ ì´ë™í•  ìœ„ì¹˜ -->
<div id="move-to-top" style="height: 1px;"></div>

<!-- ìœ íŠœë¸Œ ë™ì˜ìƒ ì£¼ì†Œë¥¼ ì…ë ¥í•˜ì—¬ ë‹¤ìš´ë¡œë“œ í•˜ëŠ” form -->
<form action="{{ url_for('main.index') }}" method="post" class="post-form" id="tube-url-search-form">
  {{ form.csrf_token }}
  <div class="row g-3 align-items-center mx-2 mt-3">
    <div class="col-auto">
      <label for="url" class="col-form-label">ìœ íŠœë¸Œ ì£¼ì†Œ</label>
    </div>
    <div class="col-sm-6">
      <input type="text" id="url" class="form-control" name="url" placeholder="ìœ íŠœë¸Œ ì£¼ì†Œ(ë³µì‚¬í•´ì„œ ë¶™ì—¬ë„£ê¸°) ì…ë ¥í•´ ì£¼ì„¸ìš”">
    </div>
    <div class="col-auto">
      <a class="btn btn-outline-primary" id="submit-btn" data-url="{{ url_for('download.check_downloadable') }}">ì¡°íšŒ</a>
      <a class="btn btn-outline-primary" id="clear-btn" hidden>ë‚´ìš© ì´ˆê¸°í™”</a>
    </div>
  </div>
</form>

<!-- ë‹¤ìš´ë¡œë“œ í”„ë¡œê·¸ë ˆìŠ¤ë°” ì˜ì—­ -->
<div class="progress-container px-2">
  <div class="progress my-4" id="progress-wrapper" hidden style="height: 2.5rem;">
    <div class="progress-bar progress-bar-striped progress-bar-animated bg-success" id="serverProgressbar"
      role="progressbar" aria-valuenow="0" aria-valuemin="0" aria-valuemax="100" style="width: 0%">0%</div>
  </div>
  <p class="m-2 p-2" id="progress-msg" style="color:blue" hidden>ì ì‹œë§Œ ê¸°ë‹¤ë ¤ ì£¼ì„¸ìš” ^^.<br>íŒŒì¼ì´ í¬ë©´,<br>ì˜¤ë˜ ê±¸ë¦´ ìˆ˜ ìˆì–´ìš” ã… ã… </p>
</div>

<!-- ë‹¤ìš´ë¡œë“œ ë²„íŠ¼ (ìˆ¨ê²¨ì§) -->
<a href="{{ url_for('download.request_file') }}" id="request-file-btn" class="btn btn-outline-primary" hidden>ë‹¤ìš´ë¡œë“œ</a>

<!-- ì‘ì€ ìŠ¤í”¼ë„ˆë§Œ ê°€ìš´ë° ë„ìš°ê¸° (ë°°ê²½ ì—†ì´) -->
<div class="loading position-fixed top-50 start-50 translate-middle" style="z-index: 1050;" hidden>
  <div class="text-center">
    <div class="spinner-border text-primary" role="status" style="width: 5rem; height: 5rem;"></div>
    <p id="loading-message" class="mt-3 fw-bold fs-5 p-2 m-1" style="background-color: beige;"></p>
  </div>
</div>

<!-- ê²€ìƒ‰ ê²°ê³¼ í‘œì‹œ: ì¸ë„¤ì¼ ì´ë¯¸ì§€, ì œëª©, ì¬ìƒì‹œê°„ -->
<div class="row my-3 mx-2">
  <div class="col-sm-10">
    <div class="row my-3 p-2 border border-dark rounded" id="tube-info-area" hidden>
      <div class="row my-1">
        <div class="col-sm-3">
          <a href="" id="tumnail-link">
            <img src="" alt="Youtube thumbnail" id="tube-thumbnail" width="100px">
          </a>
        </div>
        <div class="col-sm-9" id="tube-title"></div>
      </div>
    </div>
  </div>
</div>

<!-- ê²€ìƒ‰ ê²°ê³¼ì— ëŒ€í•œ ì•ˆë‚´ë¬¸ -->
<div class="row mb-5 mx-1" id="table-area" hidden>
  <div>
    <p style="color: red;">ë‹¤ìš´ë¡œë“œ íŒŒì¼ ìš©ëŸ‰ì€ ì˜ˆì¸¡ì¹˜ ì…ë‹ˆë‹¤. ë‹¤ìš´ë¡œë“œê°€ ì™„ë£Œëœ ì´í›„ ìš©ëŸ‰ì€ ë‹¤ë¥¼ ìˆ˜ ìˆìŠµë‹ˆë‹¤.</p>
  </div>
  <div>
    <p style="color: blue;">ìµœì  ìš©ëŸ‰/í•´ìƒë„ ì´ì™¸ ì˜µì…˜ì„ ì„ íƒí•  ê²½ìš° ì„œë²„ ì²˜ë¦¬ì‹œê°„ì´ ê¸¸ì–´ì§ˆ ìˆ˜ ìˆìŠµë‹ˆë‹¤. </p>
  </div>
  <!-- ë‹¤ìš´ë¡œë“œ ê°€ëŠ¥í•œ ëª©ë¡ -->
  <table class="table">
    <thead>
      <th>êµ¬ë¶„</th>
      <td>íƒ€ì…</td>
      <td>í¬ê¸°</td>
      <td>í•´ìƒë„</td>
      <td id="downloading" data-download-url="{{ url_for('download.downloading') }}">ë‹¤ìš´ë¡œë“œ</td>
    </thead>
    <tbody id="video-list">
    </tbody>
  </table>
</div>

<div id="request-file" data-request-file="{{ url_for('download.request_file') }}" hidden></div>

<!-- ğŸ¯ ìœ íŠœë¸Œ ì§ì ‘ ê²€ìƒ‰ ì•ˆë‚´ ë° ë²„íŠ¼ -->
<div id="tube-search-box">
  {% include 'contents/partials/tube_container.html' %}
</div>

{% include 'contents/partials/alert_modal.html' %}
{% endblock %}